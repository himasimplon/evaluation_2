CREATE DATABASE hotel CHARACTER SET 'UTF8';

USE hotel;

CREATE TABLE bed (
  id SMALLINT  UNSIGNED AUTO_INCREMENT,
  name VARCHAR(20) NOT NULL,
  
  PRIMARY KEY(id)
)
ENGINE=INNODB;

CREATE TABLE bathroom (
  id SMALLINT  UNSIGNED AUTO_INCREMENT,
  name VARCHAR(30) NOT NULL,
  
  PRIMARY KEY(id)
)
ENGINE=INNODB;

CREATE TABLE suite (
  id SMALLINT UNSIGNED AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL,
    
    PRIMARY KEY(id)
)
ENGINE=INNODB;

CREATE TABLE room (
  id SMALLINT UNSIGNED AUTO_INCREMENT,
  id_bed SMALLINT UNSIGNED NOT NULL,
  id_bathroom SMALLINT UNSIGNED NOT NULL,
  id_suite SMALLINT UNSIGNED NOT NULL,
  reduced_mobility SMALLINT NOT NULL,
  name VARCHAR(40) NOT NULL,
  area VARCHAR(20) NOT NULL,
  floor VARCHAR(15) NOT NULL,
  view VARCHAR(100) NOT NULL,
  description TEXT NOT NULL,
  price DECIMAL(10,2) NOT NULL,
  
  PRIMARY KEY(id),
  
  CONSTRAINT fk_bed
    FOREIGN KEY (id_bed)
    REFERENCES bed (id),
  CONSTRAINT fk_bathroom
    FOREIGN KEY (id_bathroom)
    REFERENCES bathroom (id),
    CONSTRAINT fk_suite
      FOREIGN KEY (id_suite)
      REFERENCES suite (id)
)
ENGINE=INNODB;

CREATE TABLE customers(
  id SMALLINT UNSIGNED AUTO_INCREMENT,
  name VARCHAR(40) NOT NULL,
  first_name VARCHAR(40) NOT NULL,
  phone VARCHAR(15) NOT NULL,
  mail VARCHAR(40) NOT NULL,
  password VARCHAR(255) NOT NULL,
  adress VARCHAR(255) NOT NULL,
  
  PRIMARY KEY(id)
)
ENGINE=INNODB;

CREATE TABLE state (
  id SMALLINT  UNSIGNED AUTO_INCREMENT,
  name VARCHAR(40) NOT NULL,
  
  PRIMARY KEY(id)
)
ENGINE=INNODB;

CREATE TABLE category_service(
  id SMALLINT UNSIGNED AUTO_INCREMENT,
  name VARCHAR(40) NOT NULL,
  
  PRIMARY KEY(id)
)
ENGINE=INNODB;

CREATE TABLE service (
  id SMALLINT UNSIGNED AUTO_INCREMENT,
  id_category SMALLINT  UNSIGNED NOT NULL, 
  name VARCHAR(40) NOT NULL,
  price DECIMAL(10,2) NOT NULL,
  description TEXT NOT NULL,
  
  PRIMARY KEY(id),

  CONSTRAINT fk_category_service
    FOREIGN KEY (id_category)
    REFERENCES category_service (id)
)
ENGINE=INNODB;

CREATE TABLE booking (
  id SMALLINT UNSIGNED AUTO_INCREMENT,
  id_room SMALLINT UNSIGNED NOT NULL,
  id_customers SMALLINT UNSIGNED NOT NULL,
  id_state SMALLINT UNSIGNED NOT NULL,
  start_stay DATETIME NOT NULL,
  end_stay DATETIME NOT NULL,
  price DECIMAL(10,2) NOT NULL,
  
  PRIMARY KEY(id),

  CONSTRAINT fk_room
    FOREIGN KEY (id_room)
    REFERENCES room (id),
  CONSTRAINT fk_customers
    FOREIGN KEY (id_customers)
    REFERENCES customers (id),
  CONSTRAINT fk_state
    FOREIGN KEY (id_state)
    REFERENCES state (id)
)
ENGINE=INNODB;

CREATE TABLE book_serve (
  id SMALLINT UNSIGNED AUTO_INCREMENT,
  id_booking SMALLINT UNSIGNED NOT NULL,
  id_service SMALLINT UNSIGNED NOT NULL,
  
  PRIMARY KEY(id),

  CONSTRAINT fk_book
    FOREIGN KEY (id_booking)
    REFERENCES booking (id),
  CONSTRAINT fk_serve
    FOREIGN KEY (id_service)
    REFERENCES service (id)
)
ENGINE=INNODB;  